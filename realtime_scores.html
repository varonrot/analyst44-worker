<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Earnings — Realtime Dashboard</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>


  <style>

    :root{
      --page-bg: #050b16;    /* overall background */
      --panel-bg: #121e2d;   /* inner panels / cards */
      --muted: #98b0bf;
      --accent: #18a7ff;
      --text: #e8f6ff;

      --success: #29c76f;
      --warning: #ffb85c;
      --danger: #ff5c7a;
      --info-soft: #3b82f6;

      --topbar-h:64px;
      --sidebar-w:260px;
      --sidebar-collapsed-w:72px;
      --nav-gap:6px;
      --nav-padding:9px 10px;
      --icon-size:18px;
      --promo-height:220px;
    }

    /* light theme variables (applied when body.light-theme) */
    body.light-theme{
      --page-bg: #f5f7fa;
      --panel-bg: #ffffff;
      --muted: #64707a;
      --accent: #2266ff;
      --text: #0b1726;
      --success: #24a85f;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info-soft: #2563eb;
    }

    @media (prefers-color-scheme: light){
      :root.auto-theme {
        --page-bg: #f5f7fa;
        --panel-bg: #ffffff;
        --muted: #64707a;
        --accent: #2266ff;
        --text: #0b1726;
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;-webkit-font-smoothing:antialiased}
    body{background:var(--page-bg);color:var(--text);transition:background .18s,color .18s}

    /* TOPBAR */
    .topbar{
      position:fixed; top:0; left:0; right:0;
      height:var(--topbar-h); display:flex; align-items:center;
      padding:8px 18px; gap:12px; background:#050b16;
      border-bottom:1px solid rgba(255,255,255,0.04); z-index:100;
    }
    .left-area{display:flex;align-items:center;gap:10px;min-width:160px}
    .logo{width:36px;height:36px;border-radius:999px;display:grid;place-items:center;
      background:radial-gradient(circle at 20% 20%,#4bf7ff,#0e9bff 40%,#2563eb 80%);
      font-weight:800;color:white;font-size:18px;
      box-shadow:0 0 18px rgba(24,167,255,.55);
    }
    .brand-title{font-weight:700;color:#ffffff;margin-left:6px;font-size:18px;letter-spacing:0.4px}
    .brand-title span{color:var(--accent);}
    .spacer{flex:1}
    .right-actions{display:flex;align-items:center;gap:10px}
    .icon-btn{width:38px;height:38px;border-radius:9px;display:inline-flex;align-items:center;justify-content:center;background:transparent;color:var(--text);position:relative;cursor:pointer;border:0}
    .icon-btn:hover{background:rgba(255,255,255,0.05)}
    .avatar{
    width:38px;
    height:38px;
    border-radius:50%;
    background-size: cover;
    background-position: center;
    box-shadow:0 4px 10px rgba(0,0,0,.25);
    cursor:pointer;
    border:2px solid rgba(255,255,255,0.18);
}

    .top-cta-edu{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 14px;border-radius:999px;
      background:var(--success);color:#fff;font-size:13px;
      font-weight:600;text-decoration:none;
      box-shadow:0 0 14px rgba(20,185,102,.5);
      border:0;cursor:pointer;
    }
    .top-cta-edu i{font-size:14px}

    /* MENU PANELS */
    .menu-panel{position:absolute; right:0; top:48px; min-width:220px; background:var(--panel-bg); border-radius:8px; padding:8px 0; box-shadow:0 14px 40px rgba(3,10,18,.6); border:1px solid rgba(255,255,255,0.03); display:none; z-index:200;}
    .menu-panel.show{display:block}
    .menu-title{padding:8px 14px;color:var(--muted);font-size:13px;border-bottom:1px solid rgba(255,255,255,0.02)}
    .menu-item{display:flex;align-items:center;gap:10px;padding:10px 14px;color:var(--text);cursor:pointer;font-size:15px;text-decoration:none}
    .menu-item:hover{background:rgba(0,0,0,0.06)}
    .menu-item .icon-small{width:30px;text-align:center;color:var(--muted)}

    .theme-panel{position:absolute; right:48px; top:48px; min-width:160px; background:var(--panel-bg); border-radius:8px; padding:6px; box-shadow:0 14px 40px rgba(3,10,18,.6); display:none; z-index:200; border:1px solid rgba(255,255,255,0.03)}
    .theme-panel.show{display:block}
    .theme-row{display:flex;align-items:center;gap:10px;padding:8px;border-radius:6px;cursor:pointer}
    .theme-row:hover{background:rgba(255,255,255,0.02)}
    .theme-row .check{margin-left:auto;color:var(--accent)}

    /* layout */
    .layout{display:flex;min-height:100vh;padding-top:var(--topbar-h)}

    /* SIDEBAR */
    .sidebar{
      position:fixed; top:var(--topbar-h); bottom:0; left:0;
      width:var(--sidebar-w);
      background:linear-gradient(180deg,#041831 0%,#064893 45%,#0f8fff 100%);
      padding:12px 6px; overflow:auto;
      transition:width .22s ease, transform .25s ease; border-right:1px solid rgba(0,0,0,0.4); z-index:90;
      display:flex; flex-direction:column;
      color:#e7f5ff;
    }
<!--    .sidebar::after{-->
<!--      content:"";-->
<!--      position:absolute;-->
<!--      right:-25px;-->
<!--      bottom:40px;-->
<!--      width:140px;-->
<!--      height:90px;-->
<!--      opacity:.16;-->
<!--      pointer-events:none;-->
<!--      background:url("data:image/svg+xml,%3Csvg%20viewBox='0%200%20120%2080'%20xmlns='http://www.w3.org/2000/svg'%3E%3Cpath%20d='M5%2060L55%2020L95%2010L75%2040L115%2060L65%2055L35%2070Z'%20fill='%23ffffff'%20fill-opacity='0.9'/%3E%3C/svg%3E") no-repeat center/contain;-->
<!--    }-->

    .section-title{color:rgba(231,245,255,.76);font-size:11px;margin:10px 8px 6px;padding-left:12px;text-transform:uppercase;letter-spacing:0.7px}
    .nav-list{display:flex;flex-direction:column;gap:var(--nav-gap);padding:0 6px 8px 6px}
    .nav-item{
      display:flex;align-items:center;gap:10px;padding:var(--nav-padding);border-radius:8px;color:#e7f5ff;text-decoration:none;
      transition:background .12s, color .12s, transform .08s;font-size:14px;
    }
    .nav-item .icon{width:34px;height:34px;border-radius:10px;display:grid;place-items:center;background:rgba(3,18,46,.3);color:#c8ddff;flex-shrink:0;font-size:var(--icon-size)}
    .nav-item .label{font-size:14px}
    .nav-item:hover{background:rgba(6,38,92,0.95);color:#fff;transform:translateY(-1px)}
    .nav-item.active{
      background:linear-gradient(90deg,rgba(21,128,255,.9),rgba(67,56,202,.9));
      color:#ffffff;
      box-shadow:0 0 16px rgba(37,99,235,.7);
    }
    .nav-item.active .icon{background:rgba(3,15,36,.6);color:#fff}

    .divider{height:1px;background:rgba(12,39,87,0.75);margin:10px 8px;border-radius:2px}

    .dropdown-btn{background:transparent;border:0;text-align:left;cursor:pointer;display:flex;align-items:center;gap:10px;padding:var(--nav-padding);border-radius:8px;color:#e7f5ff}
    .dropdown-arrow{margin-left:auto;transition:transform .18s ease}
    .dropdown-container{display:none;flex-direction:column;padding-left:46px;margin-top:6px;gap:6px}
    .dropdown-link{padding:4px 0;color:rgba(226,241,255,.85);font-size:13px;text-decoration:none}
    .dropdown-link:hover{color:#ffffff}

    .sidebar-footer{margin-top:auto;padding:12px}
    .promo{
      background:rgba(5,22,58,.9);border-radius:16px;padding:14px;border:1px solid rgba(84,180,255,0.28);
      display:flex;flex-direction:column;align-items:flex-start;gap:10px;position:relative;height:var(--promo-height);
      box-shadow:0 14px 35px rgba(3,10,30,.85);
    }
    .promo .close-btn{position:absolute;right:10px;top:8px;color:rgba(255,255,255,0.55);cursor:pointer;font-size:16px}
    .promo .art{width:72px;height:72px;border-radius:999px;display:grid;place-items:center;
      background:radial-gradient(circle at 20% 20%,#4bf7ff,#0e9bff 40%,#2563eb 80%);
      box-shadow:0 0 18px rgba(12,170,255,.65);
    }
    .promo h4{margin:6px 0 0;font-size:16px;color:#f9fbff}
    .promo p{margin:0;color:rgba(214,231,255,.85);font-size:13px}
    .promo .cta{margin-top:auto;width:100%;display:flex;justify-content:flex-start}
    .promo .cta a{background:#22c55e;color:white;padding:9px 14px;border-radius:999px;text-decoration:none;font-weight:700;display:inline-flex;align-items:center;gap:8px;font-size:13px}
    .promo .cta a i{font-size:13px}

    .sidebar.collapsed{width:var(--sidebar-collapsed-w)}
    .sidebar.collapsed .section-title,.sidebar.collapsed .label{display:none}
    .sidebar.collapsed .nav-item{justify-content:center;padding:8px}
    .sidebar.collapsed .dropdown-container{display:none!important}
    .sidebar.collapsed .promo{display:none}

    .sidebar::-webkit-scrollbar{width:8px}
    .sidebar::-webkit-scrollbar-thumb{background:rgba(3,21,45,.7);border-radius:8px}

    /* MAIN */
    .main{flex:1;margin-left:var(--sidebar-w);padding:22px 32px 120px;transition:margin-left .22s ease;background:radial-gradient(circle at top,#10203b,#050b16 55%);}
    .main.narrow{margin-left:var(--sidebar-collapsed-w)}
    .content-wide{width:100%;}
    .panel{background:var(--panel-bg);border-radius:14px;padding:18px;margin-bottom:18px;border:1px solid rgba(255,255,255,0.03)}

    /* DASHBOARD GRID */
    .dash-grid-top{
      display:grid;
      grid-template-columns: minmax(0,2.1fr) minmax(0,1.4fr) minmax(0,1.4fr);
      gap:16px;
      margin-bottom:18px;
    }
    .dash-grid-mid{
      display:grid;
      grid-template-columns: minmax(0,2.1fr) minmax(0,1.6fr);
      gap:16px;
      margin-bottom:18px;
    }
    .dash-grid-bottom{
      display:grid;
      grid-template-columns: repeat(3,minmax(0,1fr));
      gap:16px;
    }

    @media (max-width:1180px){
      .dash-grid-top{grid-template-columns: minmax(0,1.7fr) minmax(0,1.5fr);}
      .dash-grid-mid{grid-template-columns: minmax(0,1fr);}
      .dash-grid-bottom{grid-template-columns: repeat(2,minmax(0,1fr));}
    }
    @media (max-width:880px){
      .main{margin-left:0;padding:14px}
      .dash-grid-top{grid-template-columns: minmax(0,1fr);}
      .dash-grid-bottom{grid-template-columns: minmax(0,1fr);}
    }

    .card{
      background:var(--panel-bg);
      border-radius:14px;
      padding:16px 16px 14px;
      border:1px solid rgba(255,255,255,0.04);
      box-shadow:0 10px 30px rgba(0,0,0,.45);
      position:relative;
      overflow:hidden;
    }
    .card-soft{
      background:linear-gradient(135deg,rgba(24,167,255,0.08),rgba(24,167,255,0.02));
      border-color:rgba(24,167,255,0.25);
    }
    .card-header{
      display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px;
    }
    .card-title{font-size:15px;font-weight:600}
    .card-sub{font-size:13px;color:var(--muted);margin-top:2px}
    .pill{
      padding:3px 9px;border-radius:999px;font-size:11px;
      background:rgba(15,118,255,.16);color:#cce4ff;border:1px solid rgba(37,99,235,.5);
    }

    .kpi-row{display:flex;gap:14px;margin-top:14px;flex-wrap:wrap}
    .kpi{
      flex:1;min-width:130px;
      padding:10px 10px 9px;border-radius:12px;
      background:rgba(3,15,40,.9);
      border:1px solid rgba(255,255,255,0.04);
    }
    .kpi-label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:0.6px}
    .kpi-value{font-size:20px;font-weight:700;margin-top:4px}
    .kpi-change{font-size:12px;margin-top:2px}
    .kpi-change.positive{color:var(--success)}
    .kpi-change.negative{color:var(--danger)}

    .progress-bar-track{
      width:100%;height:7px;border-radius:999px;
      background:rgba(15,23,42,0.9);overflow:hidden;margin-top:8px;
    }
    .progress-bar-fill{
      height:100%;border-radius:999px;
      background:linear-gradient(90deg,#22c55e,#4ade80);
      width:75%;
    }

    .avatar-stack{
      display:flex;align-items:center;gap:0;
      margin-top:10px;
    }
    .avatar-stack img{
      width:26px;height:26px;border-radius:999px;border:2px solid #0b1726;
      object-fit:cover;box-shadow:0 2px 6px rgba(0,0,0,.5);
      margin-right:-8px;
    }
    .avatar-stack span{
      font-size:11px;color:var(--muted);margin-left:8px;
    }

    .chip-date{
      width:60px;height:60px;border-radius:999px;
      background:radial-gradient(circle at 30% 20%,#4bf7ff,#2563eb);
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      font-weight:700;color:#eff6ff;font-size:14px;
    }
    .chip-date small{font-size:10px;font-weight:500;opacity:.85}

    .btn-green{
      display:inline-flex;align-items:center;gap:8px;
      padding:9px 14px;border-radius:999px;
      background:var(--success);color:#f9fdfb;font-size:13px;font-weight:600;
      border:0;text-decoration:none;cursor:pointer;
      box-shadow:0 0 16px rgba(34,197,94,.6);
      margin-top:16px;
    }
    .btn-green i{font-size:14px}

    .mini-tag{font-size:11px;padding:3px 7px;border-radius:999px;background:rgba(15,118,255,0.16);color:#bfdbfe}
    .stat-row{display:flex;justify-content:space-between;align-items:center;margin:6px 0;font-size:13px;color:var(--muted);}
    .stat-row strong{color:var(--text);}

    .bar-chart{
      margin-top:14px;display:flex;align-items:flex-end;gap:8px;height:120px;
    }
    .bar{
      flex:1;border-radius:6px 6px 0 0;
      background:linear-gradient(180deg,#38bdf8,#0ea5e9);
      position:relative;
    }
    .bar:nth-child(2){height:70%;opacity:.85}
    .bar:nth-child(3){height:90%;}
    .bar:nth-child(4){height:55%;opacity:.8}
    .bar:nth-child(5){height:65%;}
    .bar:nth-child(6){height:40%;opacity:.7}
    .bar-labels{display:flex;justify-content:space-between;margin-top:6px;font-size:11px;color:var(--muted);}

    .activity-item{font-size:13px;color:var(--muted);margin-bottom:10px;display:flex;justify-content:space-between;gap:8px}
    .activity-item span:first-child{color:var(--text);}

    .pill-small{
      padding:2px 7px;border-radius:999px;font-size:10px;
      background:rgba(15,23,42,.9);color:var(--muted);
    }

    @media (max-width:920px){
      .sidebar{transform:translateX(-110%);position:fixed}
      .sidebar.open{transform:translateX(0)}
      .main{margin-left:0;padding:12px}
      .right-actions .cart-btn,
      .right-actions .notify-btn,
      .right-actions .apps-btn{display:none}
      .right-actions{gap:8px}
    }

    .icon-btn:focus, .menu-item:focus, .dropdown-btn:focus{outline:2px solid rgba(28,121,210,.18);outline-offset:2px}

          /* TOP STRIP / CRM HERO */
    .crm-hero-card{
      margin-bottom:18px;
      padding:16px 22px;
      border-radius:16px;
      background:linear-gradient(90deg,#050b16,#061426 40%,#061a33 80%);
      border:1px solid rgba(148,163,184,0.25);
      box-shadow:0 18px 40px rgba(0,0,0,.75);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:24px;
    }

    .crm-hero-left{
      display:flex;
      align-items:center;
      gap:18px;
      min-width:0;
    }

    .crm-hero-icon{
      position:relative;
      width:78px;
      height:78px;
      border-radius:24px;
      overflow:hidden;
      background:radial-gradient(circle at 20% 20%,#38bdf8,#0ea5e9 45%,#1d4ed8 80%);
      box-shadow:0 0 32px rgba(56,189,248,0.75);
      flex-shrink:0;
    }
    .crm-hero-icon img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:contain;
      pointer-events:none;
    }

    .crm-hero-text h1{
      margin:0;
      font-size:22px;
      font-weight:700;
    }
    .crm-hero-text h1 span{
      color:var(--accent);
    }
    .crm-hero-text p{
      margin:4px 0 0;
      font-size:13px;
      color:var(--muted);
    }

    .crm-hero-sub{
      margin-top:8px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      font-size:11px;
      color:var(--muted);
    }
    .crm-hero-pill{
      padding:3px 9px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.4);
      background:rgba(15,23,42,0.85);
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .crm-hero-pill i{
      font-size:12px;
      color:var(--accent);
    }

    .crm-hero-right{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:6px;
      font-size:12px;
      color:var(--muted);
      flex-shrink:0;
    }
    .crm-date-label{
      text-transform:uppercase;
      letter-spacing:0.5px;
      font-size:11px;
    }
    .crm-date-btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 12px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.55);
      background:rgba(15,23,42,0.95);
      color:var(--text);
      font-size:12px;
      cursor:pointer;
    }
    .crm-date-btn i{
      font-size:13px;
      color:var(--accent);
    }
    .crm-date-btn:hover{
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(37,99,235,0.65);
    }

    @media (max-width:900px){
      .crm-hero-card{
        flex-direction:column;
        align-items:flex-start;
      }
      .crm-hero-right{
        align-items:flex-start;
      }
    }
       .crm-hero-icon i{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:32px;
      color:#ffffff;
    }
/* ===== REALTIME RESULTS STRIP ===== */

.rt-results-section{
  margin-top:18px;
}

.rt-results-row{
  display:grid;
  grid-template-columns:minmax(0,1.6fr) minmax(0,1.5fr) minmax(0,1.5fr);
  gap:16px;
}

@media (max-width:1200px){
  .rt-results-row{
    grid-template-columns:minmax(0,1.5fr) minmax(0,1.5fr);
  }
  .rt-results-row > :last-child{
    grid-column:1 / -1;
  }
}
@media (max-width:880px){
  .rt-results-row{
    grid-template-columns:minmax(0,1fr);
  }
}

.rt-card{
  background:#0b1726;
  border-radius:16px;
  border:1px solid rgba(15,23,42,0.9);
  padding:18px 20px 16px;
  box-shadow:0 18px 45px rgba(0,0,0,0.65);
}

.rt-card-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  margin-bottom:12px;
}

.rt-card-title{
  font-size:15px;
  font-weight:600;
  color:#f9fafb;
}

.rt-card-sub{
  margin-top:3px;
  font-size:12px;
  color:#8b9bb4;
}

/* --- שמאל: Trending symbols --------------------------------------- */

.rt-symbol-cloud{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  margin-top:8px;
  margin-bottom:12px;
}

.rt-symbol{
  min-width:64px;
  height:64px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:13px;
  font-weight:600;
  color:#e5f3ff;
  background:radial-gradient(circle at 20% 20%,#38bdf8,#2563eb);
  box-shadow:0 10px 24px rgba(15,23,42,0.9);
}

.rt-symbol.small{
  min-width:52px;
  height:52px;
  font-size:12px;
  opacity:0.9;
}

.rt-card-footer{
  border-top:1px solid rgba(15,23,42,0.85);
  padding-top:9px;
  margin-top:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}

.rt-select{
  padding:6px 14px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.55);
  background:#020617;
  color:#e5e7eb;
  font-size:12px;
}

.rt-link{
  font-size:12px;
  color:#38bdf8;
  cursor:pointer;
}

/* --- אמצע: Session progress --------------------------------------- */

.rt-session-metrics{
  display:flex;
  flex-direction:column;
  gap:14px;
  margin-top:6px;
}

.rt-metric-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:12px;
  color:#9ca3af;
}

.rt-metric-head strong{
  font-size:18px;
  color:#f9fafb;
}

.rt-bar-track{
  width:100%;
  height:8px;
  border-radius:999px;
  background:#020617;
  overflow:hidden;
  margin-top:6px;
}

.rt-bar-fill-main{
  height:100%;
  width:63%;
  background:linear-gradient(90deg,#22c55e,#4ade80);
  border-radius:999px;
}

.rt-bar-fill-secondary{
  height:100%;
  width:80%;
  background:linear-gradient(90deg,#38bdf8,#0ea5e9);
  border-radius:999px;
}

.rt-bar-fill-highscore{
  height:100%;
  width:38%;
  background:linear-gradient(90deg,#2563eb,#38bdf8,#22c55e);
  border-radius:999px;
}

.rt-badge{
  padding:3px 10px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.6);
  background:#020617;
  font-size:11px;
  color:#9ca3af;
}

.rt-dot{
  width:9px;
  height:9px;
  border-radius:999px;
  background:#3b82f6;
}

.rt-dot.secondary{
  background:#1f2937;
}
/* GRID FOR SECTION 3 */
.dash-grid-3 {
  margin-top: 22px;
  display: grid;
  grid-template-columns: 1fr;
}

/* TABLE WRAPPER */
.table-wrapper {
  width: 100%;
  overflow-x: auto;
  margin-top: 10px;
}

/* TABLE BASE */
.a44-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
  color: #dce7f6;
}

.a44-table thead tr {
  background: rgba(255, 255, 255, 0.04);
}

.a44-table th {
  text-align: left;
  padding: 12px 10px;
  font-weight: 600;
  font-size: 12px;
  color: #8ea2b7;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}

.a44-table td {
  padding: 12px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
}

.a44-table tr:hover {
  background: rgba(255,255,255,0.04);
}

/* SYMBOL TAGS */
.tag-symbol {
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 600;
  color: #fff;
}
.tag-symbol.bull { background: #2563eb; }   /* Blue */
.tag-symbol.bear { background: #ef4444; }  /* Red */

/* DIRECTION BADGES */
.dir {
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 600;
}
.dir.long  { background: rgba(16,185,129,.2); color:#10b981; border:1px solid #10b981; }
.dir.short { background: rgba(239,68,68,.2);  color:#ef4444; border:1px solid #ef4444; }

/* VOLATILITY BADGES */
.vol {
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 600;
}
.vol.low  { background:#1e3a8a; color:#93c5fd; }
.vol.med  { background:#0f172a; color:#60a5fa; }
.vol.high { background:#450a0a; color:#f87171; }
/* SECTION 3 RESPONSIVE GRID */
.section-four-grid {
  display: grid;
  grid-template-columns: 2fr 2fr 1.3fr;
  gap: 20px;
  margin-top: 20px;
}

/* MOBILE MODE */
@media (max-width: 820px) {
  .section-four-grid {
    grid-template-columns: 1fr !important;
    gap: 16px;
  }

  .calendar-card,
  .event-list,
  .upgrade-card {
    padding: 16px !important;
  }

  .calendar-grid {
    grid-template-columns: repeat(7, 1fr);
  }

  .day {
    padding: 8px 0;
    font-size: 13px;
  }

  .price-box .price {
    font-size: 32px;
  }

  .btn-upgrade {
    font-size: 15px;
    padding: 14px;
  }
}


.card {
  background: #0f1625;
  border-radius: 14px;
  padding: 20px;
  border: 1px solid rgba(255,255,255,0.05);
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
  color: #e8f0ff;
}

/* Calendar */
.calendar-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 12px;
}

.btn-small {
  border: 1px solid rgba(255,255,255,0.15);
  background: transparent;
  color: #70b7ff;
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
}

.calendar-nav {
  display: flex;
  gap: 8px;
}

.btn-nav, .btn-today {
  background: #0b1220;
  border: 1px solid rgba(255,255,255,0.08);
  color: #cfe7ff;
  padding: 6px 10px;
  border-radius: 8px;
}

.calendar-weekdays {
  display: grid;
  grid-template-columns: repeat(7,1fr);
  text-align: center;
  margin: 10px 0;
  font-weight: 600;
  color: #86a0c0;
}

.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7,1fr);
  gap: 6px;
}

.day {
  padding: 10px 0;
  text-align: center;
  border-radius: 10px;
  background: #0b1220;
  color: #cfdfff;
}

.day.muted { opacity: .35; }

.highlight-blue { border: 2px solid #296dff; color: #85a8ff; }
.highlight-green { border: 2px solid #1dd68e; color: #98ffd2; }
.highlight-orange { border: 2px solid #ff8b3d; color: #ffcaa0; }

.selected {
  background: #2461ff;
  color: white;
  font-weight: 700;
}

/* Events */
.event-list h3 {
  margin: 0;
  font-size: 20px;
}

.event-day {
  color: #7fa0c8;
  margin-bottom: 16px;
}

.event-item {
  display: flex;
  gap: 12px;
  margin-bottom: 18px;
}

.event-item .dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-top: 6px;
}

.event-item.blue .dot { background: #3b82f6; }
.event-item.green .dot { background: #22c55e; }
.event-item.orange .dot { background: #f59e0b; }
.event-item.red .dot { background: #ef4444; }

/* Upgrade Card */
.upgrade-card h2 {
  margin: 0;
  font-size: 24px;
}

.sub {
  margin-top: 4px;
  color: #96b7ff;
}

.blue-text { color: #4ea4ff; }

.price-box {
  background: #0f8d37;
  padding: 16px;
  border-radius: 12px;
  margin: 16px 0;
  text-align: center;
}

.price {
  font-size: 38px;
  font-weight: 700;
}

.month {
  font-size: 18px;
  opacity: .8;
}

.features {
  list-style: none;
  padding: 0;
  margin: 0 0 18px 0;
}

.features li {
  display: flex;
  gap: 10px;
  margin-bottom: 10px;
  color: #cde7ff;
}

.btn-upgrade {
  width: 100%;
  padding: 12px;
  background: #16c85f;
  border: 0;
  border-radius: 12px;
  color: white;
  font-weight: 700;
  cursor: pointer;
  font-size: 14px;
  box-shadow: 0 0 12px rgba(22,200,95,0.6);
}
.scores-section {
  margin-top: 24px;
  background: linear-gradient(180deg, #0b1526, #0e182f);
  padding: 18px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.05);
  width: 100%;
  overflow-x: hidden;
}

/* טבלה רספונסיבית */
.table-container {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

.scores-table {
  width: 100%;
  border-collapse: collapse;
  min-width: 900px;
}

.scores-table th,
.scores-table td {
  padding: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  white-space: nowrap;
}

.scores-table th {
  color: #9fb4c9;
  font-weight: 600;
}

.scores-table tr:hover {
  background: rgba(255,255,255,0.05);
}


.scores-sub {
  font-size: 13px;
  color: #8ea2b7;
  margin-top: 4px;
  margin-bottom: 14px;
}

.scores-wrapper {
  max-height: 720px;
  overflow-y: auto;
  overflow-x: hidden;
  padding-right: 6px;
}

.scores-fancy-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  color: #e4eefc;
}

.scores-fancy-table thead tr {
  background: rgba(255,255,255,0.03);
}

.scores-fancy-table th {
  text-align: left;
  padding: 12px;
  font-size: 12px;
  font-weight: 600;
  color: #8ea2b7;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}

.scores-fancy-table td {
  padding: 14px 12px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
}

/* Hover row */
.scores-fancy-table tr:hover {
  background: rgba(255,255,255,0.04);
}

/* Symbol badge */
.sym-badge {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 15px;
  color: #fff;
  margin-right: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.32);
}

/* badge colors */
.bg-green { background:#0c5e33; }
.bg-red   { background:#7b1212; }
.bg-blue  { background:#103b75; }
.bg-orange{ background:#7b4312; }

/* score bar */
.score-bar {
  width: 120px;
  height: 8px;
  border-radius: 999px;
  background: #1b2538;
  overflow: hidden;
  position: relative;
}

.score-fill {
  height: 100%;
  background: linear-gradient(90deg,#3ba7ff,#2583ff);
  border-radius: 999px;
}

/* circle stat */
.stat-circle {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.14);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  font-weight: 600;
  color: #fff;
}

/* stat colors */
.stat-red { border-color:#ef4444; color:#ef4444; }
.stat-green { border-color:#10b981; color:#10b981; }
.stat-yellow { border-color:#fbbf24; color:#fbbf24; }
.stat-blue { border-color:#3b82f6; color:#3b82f6; }



      .score-bar {
  width: 120px;
  height: 8px;
  border-radius: 20px;
  background: #2a3444;
  overflow: hidden;
  display: inline-block;
  vertical-align: middle;
  margin-right: 8px;
}

.score-fill {
  height: 100%;
  background: linear-gradient(90deg, #3ba7ff, #2b7bff);
  border-radius: 20px;
}

.score-label {
  font-size: 13px;
  color: #a8b5c9;
}


      /* Trending symbol circles – final size fix */
.rt-symbol {
  width: 70px !important;
  height: 70px !important;
  border-radius: 50%;
  background: linear-gradient(135deg, #5bb8ff, #3d7bff);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: 600;
  color: white;
  cursor: default;
  transition: transform 0.15s ease;
}

.rt-symbol.small {
  width: 55px !important;
  height: 55px !important;
  font-size: 14px;
}

@media (max-width: 820px) {
  .scores-section {
    display: none;
  }
}
.scores-mobile {
  display: none;
  background: #0b1526;
  padding: 18px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.05);
  margin-top: 20px;
}

.scores-mobile-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  color: #e4eefc;
}

.scores-mobile-table th,
.scores-mobile-table td {
  padding: 12px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}

@media (max-width: 820px) {
  .scores-mobile {
    display: block;
  }
}

/* Mobile scores table — limit height + scroll */
@media (max-width: 768px) {
    .scores-mobile-table-wrapper {
        max-height: 400px;   /* בערך 8 שורות */
        overflow-y: auto;    /* גלילה אנכית */
        overflow-x: hidden;
        margin-top: 10px;
        border-radius: 10px;
        border: 1px solid rgba(255,255,255,0.08);
    }

    .scores-mobile-table {
        width: 100%;
        border-collapse: collapse;
    }

    .scores-mobile-table th,
    .scores-mobile-table td {
        padding: 12px 14px;
        font-size: 15px;
        border-bottom: 1px solid rgba(255,255,255,0.06);
    }

    /* ←add */
    .scores-mobile-table th,
    .scores-mobile-table td {
        text-align: left !important;
    }
}
/* Hide hero pills on mobile */
@media (max-width: 820px) {
  .crm-hero-sub {
    display: none !important;
  }
}

.scores-fancy-table thead th {
  position: sticky;
  top: 0;
  background: #0f1625;
  z-index: 10;
}


.scores-mobile-table thead th {
  position: sticky;
  top: 0;
  background: #0b1526;
  z-index: 10;
}


      /* Low (<=30) – strong red */
.score-low {
  color: #ff4f4f;
  font-weight: 600;
}

/* Neutral 45–55 – blue */
.score-neutral {
  color: #4eaaff;
  font-weight: 600;
}

/* High (>=70) – strong green */
.score-high {
  color: #4fffa1;
  font-weight: 600;
}

/* Mid (31–69 but outside neutral) – softer gradient */
.score-mid {
  font-weight: 600;
}

/* Mid values closer to low range: 31–44 */
.score-mid[value-low] {
  color: #ff8a8a;
}

/* Mid values closer to high range: 56–69 */
.score-mid[value-high] {
  color: #7bffb7;
}

/* Red Shades (Low 0–40) */
.score-red-1 { color: #F21111; }
.score-red-2 { color: #F22727; }
.score-red-3 { color: #F24444; }
.score-red-4 { color: #F24B4B; }
.score-red-5 { color: #F25555; }
.score-red-6 { color: #F06262; }

/* Blue Shades (Mid 40–60) */
.score-blue-1 { color: #4091F5; }
.score-blue-2 { color: #328BED; }
.score-blue-3 { color: #1B81F2; }

/* Green Shades (High 60–100) */
.score-green-1 { color: #8DF2CA; }
.score-green-2 { color: #66F2BA; }
.score-green-3 { color: #51F0B0; }
.score-green-4 { color: #42EDA8; }
.score-green-5 { color: #2BED9E; }
.score-green-6 { color: #15E892; }

      /* ===== Earnings Reaction Section ===== */

.dash-grid-mid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 20px;
}

.card {
    background: #0e1624;
    border-radius: 14px;
    padding: 20px;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.card-title {
    font-size: 16px;
    font-weight: 600;
    color: #ffffff;
}

.card-sub {
    font-size: 13px;
    color: #9fb0c7;
}

.stat-row {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    margin-bottom: 8px;
    color: #c8d2e2;
}

#price-chart {
    width: 100%;
    height: 420px;
}

/* Responsive */
@media (max-width: 1024px) {
    .dash-grid-mid {
        grid-template-columns: 1fr;
    }
}
.ai-text-block {
  margin-bottom: 14px;
}

.ai-text-title {
  font-size: 13px;
  font-weight: 600;
  color: #9fdcff;
  margin-bottom: 6px;
}

.ai-text-content {
  font-size: 13px;
  line-height: 1.45;
  color: #e5e7eb;
  opacity: 0.95;
}
.apexcharts-tooltip {
  background: #0b1726 !important;
  color: #e5e7eb !important;
  border: 1px solid rgba(255,255,255,0.12);
}

.apexcharts-tooltip * {
  color: #e5e7eb !important;
}

      .row-selected {
  background: rgba(59,130,246,0.14);
  outline: 1px solid rgba(59,130,246,0.35);
}

.rt-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  column-gap: 32px;
  row-gap: 20px;
}

.rt-card {
  background: #0b1726;
  border-radius: 16px;
  padding: 20px;
}

.rt-title {
  font-size: 16px;
  font-weight: 600;
  color: #fff;
}

.rt-sub {
  font-size: 13px;
  color: #9fb4d1;
  margin-bottom: 14px;
}

/* circles */
.ts-container {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.ts-circle {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: #4f9cff;
  color: #fff;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.rt-summary {
  margin-bottom: 20px;
}

      /* ===== DESKTOP ===== */
.rt-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  align-items: stretch;
}

/* ===== TABLET ===== */
@media (max-width: 1024px) {
  .rt-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ===== MOBILE ===== */
@media (max-width: 768px) {
  .rt-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }

  .rt-card {
    width: 100%;
  }
}
/* ====== COMMON CARD ====== */
.rt-card {
  background: radial-gradient(120% 120% at 0% 0%, #0b1c32, #060d18);
  border-radius: 18px;
  padding: 18px 20px;
  min-height: 220px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

/* ====== TITLES ====== */
.rt-title {
  font-size: 16px;
  font-weight: 700;
  color: #e5f0ff;
}

.rt-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.rt-badge {
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 10px;
  background: #0b223f;
  color: #7dd3fc;
}

/* ====== PROGRESS CARD ====== */
.rt-progress-card {
  gap: 14px;
}

.rt-metric {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.rt-metric.small {
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
}

.rt-label {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
  color: #cbd5f5;
}

.rt-bar {
  height: 8px;
  border-radius: 6px;
  background: #0b1726;
  overflow: hidden;
}

.rt-bar-fill {
  height: 100%;
  border-radius: 6px;
}

.rt-bar-fill.green {
  background: linear-gradient(90deg, #22c55e, #4ade80);
}

.rt-bar-fill.blue {
  background: linear-gradient(90deg, #38bdf8, #60a5fa);
}

/* ====== PIE CARD ====== */
.rt-pie-card {
  justify-content: center;
}

.rt-pie-layout {
  display: flex;
  align-items: center;
  gap: 18px;
}

.rt-pie-legend {
  display: flex;
  flex-direction: column;
  gap: 10px;
  font-size: 13px;
}

.legend-row {
  display: grid;
  grid-template-columns: 14px 1fr auto;
  align-items: center;
  gap: 8px;
  color: #cbd5f5;
}

.dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

.dot.positive {
  background: #60a5fa;
}

.dot.negative {
  background: #334155;
}

      .winners-card {
  display: flex;
  flex-direction: column;
}

.winners-layout {
  display: flex;
  align-items: center;
  gap: 18px;
  margin-top: 12px;
}

.winners-legend {
  display: flex;
  flex-direction: column;
  gap: 10px;
  font-size: 13px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.legend-item strong {
  margin-left: auto;
  font-weight: 700;
}

.dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
}

.dot.positive {
  background: #3b82f6;
}

.dot.negative {
  background: #334155;
}

      .winners-layout{
  display:flex;
  align-items:center;
  gap:18px;
  margin-top:12px;
}

.winners-legend{
  display:flex;
  flex-direction:column;
  gap:10px;
  font-size:13px;
}

.legend-item{
  display:flex;
  align-items:center;
  gap:8px;
}

.legend-item strong{
  margin-left:auto;
  font-weight:700;
}

.dot{
  width:10px;
  height:10px;
  border-radius:50%;
}

.dot.positive{ background:#3b82f6; }
.dot.negative{ background:#334155; }

.winners-layout canvas {
  width: 140px !important;
  height: 140px !important;
  max-width: 140px;
  max-height: 140px;
}
.trading-context {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 18px;
  margin-bottom: 22px;
}

/* CARD */
.context-card {
  background: linear-gradient(180deg, #0c1626, #0a1422);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 14px;
  padding: 16px 18px;
}

/* TITLE */
.context-title {
  font-size: 12px;
  letter-spacing: 0.6px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.55);
  margin-bottom: 8px;
}

/* VALUE */
.context-value {
  font-size: 15px;
  font-weight: 500;
  color: rgba(255,255,255,0.95);
  margin-bottom: 8px;
}

.context-value.warning {
  color: #facc15;
}

/* BAR */
.context-bar {
  position: relative;
  height: 3px;
  background: rgba(255,255,255,0.15);
  border-radius: 3px;
  margin-bottom: 10px;
}

.context-bar span {
  position: absolute;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #cbd5f5;
}

.context-bar span.warn {
  background: #facc15;
}

/* NOTE */
.context-note {
  font-size: 12px;
  color: rgba(255,255,255,0.55);
  line-height: 1.4;
}

/* RESPONSIVE */
@media (max-width: 1200px) {
  .trading-context {
    grid-template-columns: 1fr;
  }
}
.session-intel {
  margin-top: 26px;
  margin-bottom: 26px;
}

.session-header {
  font-size: 12px;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.55);
  margin-bottom: 14px;
}

.session-grid {
  display: grid;
  grid-template-columns: 1.4fr 1.4fr 1fr;
  gap: 18px;
}

/* CARD */
.session-card {
  background: linear-gradient(180deg, #0c1626, #0a1422);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 14px;
  padding: 16px 18px;
}

/* TITLE */
.session-title {
  font-size: 13px;
  font-weight: 500;
  color: rgba(255,255,255,0.85);
  margin-bottom: 12px;
}

/* TABLE */
.log-table-wrapper {
  max-height: 220px; /* ~8 rows */
  overflow-y: auto;
}

.log-table {
  width: 100%;
  border-collapse: collapse;
}

.log-table td {
  font-size: 12px;
  color: rgba(255,255,255,0.65);
  padding: 6px 0;
  border-bottom: 1px solid rgba(255,255,255,0.04);
}

.log-table td:first-child {
  width: 48px;
  color: rgba(255,255,255,0.4);
}

/* STATES */
.log-table tr.trade td {
  color: #4ade80;
}

.log-table tr.skip td {
  color: #facc15;
}

/* OUTCOMES */
.outcomes-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-bottom: 12px;
}

.outcome-metric {
  font-size: 12px;
  color: rgba(255,255,255,0.6);
  display: flex;
  justify-content: space-between;
}

.outcome-metric .value {
  color: rgba(255,255,255,0.9);
}

.outcome-metric.success .value {
  color: #4ade80;
}

.outcome-metric.fail .value {
  color: #ef4444;
}

/* PIE PLACEHOLDER */
.pie-placeholder {
  height: 120px;
  border-radius: 10px;
  background: repeating-linear-gradient(
    135deg,
    rgba(255,255,255,0.06),
    rgba(255,255,255,0.06) 10px,
    rgba(255,255,255,0.03) 10px,
    rgba(255,255,255,0.03) 20px
  );
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  color: rgba(255,255,255,0.4);
  margin-bottom: 10px;
}

/* AI SUMMARY */
.session-summary {
  font-size: 12px;
  color: rgba(255,255,255,0.6);
  line-height: 1.45;
}

/* RESPONSIVE */
@media (max-width: 1200px) {
  .session-grid {
    grid-template-columns: 1fr;
  }
}
.ai-decision-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 24px;
  padding: 18px 22px;
  margin-bottom: 22px;

  background: linear-gradient(180deg, #0b1524, #0a1321);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 16px;
}

/* LEFT */
.ai-decision-left {
  max-width: 72%;
}

.ai-decision-title {
  font-size: 13px;
  letter-spacing: 0.7px;
  text-transform: uppercase;
  color: rgba(255,255,255,0.6);
  margin-bottom: 8px;
}

.ai-decision-text {
  font-size: 14px;
  color: rgba(255,255,255,0.85);
  line-height: 1.55;
}

.ai-decision-text b {
  color: #4ade80;
  font-weight: 500;
}

/* RIGHT */
.ai-decision-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 10px;
}

.ai-decision-badge {
  font-size: 11px;
  padding: 4px 10px;
  border-radius: 999px;
  background: rgba(74, 222, 128, 0.12);
  color: #4ade80;
  border: 1px solid rgba(74, 222, 128, 0.25);
}

.ai-decision-btn {
  padding: 8px 16px;
  font-size: 13px;
  border-radius: 10px;
  border: none;
  cursor: pointer;

  background: linear-gradient(90deg, #22c55e, #4ade80);
  color: #03110a;
  font-weight: 500;
}

.ai-decision-btn:hover {
  opacity: 0.9;
}

/* RESPONSIVE */
@media (max-width: 1200px) {
  .ai-decision-bar {
    flex-direction: column;
    align-items: flex-start;
  }

  .ai-decision-left {
    max-width: 100%;
  }

  .ai-decision-right {
    align-items: flex-start;
  }
}

  </style>

</head>
<body>



  <!-- TOPBAR -->
  <header class="topbar" role="banner">
    <div class="left-area">
      <button class="icon-btn" id="sidebarToggle" title="Toggle sidebar" aria-label="Toggle sidebar"><i class="fa-solid fa-bars"></i></button>
      <a href="landing.html" class="spa-link" style="text-decoration:none; display:flex;align-items:center;gap:8px">
         <div class="logo">A</div>
         <div class="brand-title">analyst44</div>
      </a>
    </div>

    <div class="spacer"></div>

<!--    <div class="right-actions" role="navigation" aria-label="Top actions">-->
<!--      &lt;!&ndash; education CTA &ndash;&gt;-->
<!--      <a href="education/index.html" class="top-cta-edu spa-link">-->
<!--        <i class="fa-solid fa-play"></i>-->
<!--        <span>Open education hub</span>-->
<!--      </a>-->

      <div class="dropdown" style="position:relative">
        <button class="icon-btn" id="themeToggle" title="Theme" aria-haspopup="true" aria-expanded="false"><i class="fa-regular fa-moon"></i></button>
        <div class="theme-panel" id="themePanel" role="menu" aria-hidden="true">
          <div class="menu-title">Theme</div>
          <div class="theme-row" data-theme="light" role="menuitem" tabindex="0"><span style="width:26px;text-align:center"><i class="fa-solid fa-sun"></i></span><div>Light</div><div class="check" aria-hidden="true" style="display:none">✓</div></div>
          <div class="theme-row" data-theme="dark" role="menuitem" tabindex="0"><span style="width:26px;text-align:center"><i class="fa-regular fa-moon"></i></span><div>Dark</div><div class="check" aria-hidden="true" style="display:none">✓</div></div>
          <div class="theme-row" data-theme="auto" role="menuitem" tabindex="0"><span style="width:26px;text-align:center"><i class="fa-regular fa-circle-half-stroke"></i></span><div>Auto</div><div class="check" aria-hidden="true" style="display:none">✓</div></div>
        </div>
      </div>

      <!-- cart -->
      <a class="icon-btn cart-btn" href="purchase.html" title="Cart" aria-label="Cart"><i class="fa-solid fa-cart-shopping"></i></a>

      <!-- notifications -->
      <a class="icon-btn notify-btn" href="notifications.html" title="Notifications" aria-label="Notifications"><i class="fa-regular fa-bell"></i></a>

      <!-- apps -->
      <a class="icon-btn apps-btn" href="apps.html" title="Apps" aria-label="Apps"><i class="fa-solid fa-grid"></i></a>

      <div class="dropdown" id="userDropdown">
        <div id="userAvatar" class="avatar"></div>
        <div class="menu-panel" id="userMenu" role="menu" aria-hidden="true">
          <div class="menu-title">Account</div>
          <a class="menu-item" href="purchase.html"><span class="icon-small"><i class="fa-solid fa-crown"></i></span><span>Upgrade to Pro</span></a>
          <a class="menu-item" href="profile.html"><span class="icon-small"><i class="fa-regular fa-user"></i></span><span>Profile</span></a>
          <a class="menu-item" href="feedback.html"><span class="icon-small"><i class="fa-regular fa-comment-dots"></i></span><span>Feedback</span></a>
          <a class="menu-item" href="settings.html"><span class="icon-small"><i class="fa-solid fa-gear"></i></span><span>Settings</span></a>
          <a class="menu-item" href="logout.html" id="logoutBtn"><span class="icon-small"><i class="fa-solid fa-right-from-bracket"></i></span><span>Logout</span></a>
        </div>
      </div>

  </header>

  <div class="layout">
    <aside class="sidebar" id="sidebar" role="navigation" aria-label="Main navigation">
      <div class="section-title">Main</div>
      <nav class="nav-list" aria-label="Main nav">
        <a class="nav-item active spa-link" href="dashboard.html"><span class="icon"><i class="fa-solid fa-house"></i></span><span class="label">Dashboard</span></a>

        <button class="dropdown-btn" aria-expanded="false">
          <span class="icon"><i class="fa-solid fa-bolt"></i></span><span class="label">Realtime</span><i class="fa-solid fa-chevron-down dropdown-arrow"></i>
        </button>
        <div class="dropdown-container">
          <a class="dropdown-link spa-link" href="realtime_live.html">Live Feed</a>
          <a class="dropdown-link spa-link" href="realtime_scores.html">Scores</a>
          <a class="dropdown-link spa-link" href="realtime_alerts.html">Alerts</a>
        </div>

        <a class="nav-item spa-link" href="watchlists.html"><span class="icon"><i class="fa-regular fa-star"></i></span><span class="label">Watchlists</span></a>
        <a class="nav-item spa-link" href="universe.html"><span class="icon"><i class="fa-solid fa-layer-group"></i></span><span class="label">Universe</span></a>
      </nav>

      <div class="divider"></div>

      <div class="section-title">Analysis</div>
      <nav class="nav-list" aria-label="Analysis">
        <a class="nav-item spa-link" href="income.html"><span class="icon"><i class="fa-regular fa-file-lines"></i></span><span class="label">Income Statement</span></a>
        <a class="nav-item spa-link" href="balance.html"><span class="icon"><i class="fa-solid fa-balance-scale"></i></span><span class="label">Balance Sheet</span></a>
        <a class="nav-item spa-link" href="cashflow.html"><span class="icon"><i class="fa-solid fa-droplet"></i></span><span class="label">Cash Flow</span></a>
        <a class="nav-item spa-link" href="consensus.html"><span class="icon"><i class="fa-solid fa-people-roof"></i></span><span class="label">Consensus</span></a>
        <a class="nav-item spa-link" href="calendar.html"><span class="icon"><i class="fa-solid fa-calendar-days"></i></span><span class="label">Earnings Calendar</span></a>
      </nav>

      <div class="divider"></div>

      <div class="section-title">Reports</div>
      <nav class="nav-list" aria-label="Reports">
        <a class="nav-item spa-link" href="reports_latest.html"><span class="icon"><i class="fa-solid fa-file-lines"></i></span><span class="label">Latest Reports</span></a>
        <a class="nav-item spa-link" href="reports_archive.html"><span class="icon"><i class="fa-solid fa-clock-rotate-left"></i></span><span class="label">Archive</span></a>
        <a class="nav-item spa-link" href="reports_compare.html"><span class="icon"><i class="fa-solid fa-scale-balanced"></i></span><span class="label">Peer Comparison</span></a>
      </nav>

      <div class="divider"></div>

      <div class="section-title">Tools</div>
      <nav class="nav-list" aria-label="Tools">
        <a class="nav-item spa-link" href="screener.html"><span class="icon"><i class="fa-solid fa-magnifying-glass-chart"></i></span><span class="label">Screener</span></a>
        <a class="nav-item spa-link" href="backtest.html"><span class="icon"><i class="fa-solid fa-play-circle"></i></span><span class="label">Backtest</span></a>
        <a class="nav-item spa-link" href="alerts.html"><span class="icon"><i class="fa-regular fa-bell"></i></span><span class="label">Alerts</span></a>
        <a class="nav-item spa-link" href="export.html"><span class="icon"><i class="fa-solid fa-file-export"></i></span><span class="label">Export</span></a>
      </nav>

      <div class="divider"></div>

      <div class="section-title">Pages</div>
      <nav class="nav-list" aria-label="Pages">
        <a class="nav-item spa-link" href="how-analyst44-works.html"><span class="icon"><i class="fa-regular fa-circle-question"></i></span><span class="label">Help</span></a>
        <a class="nav-item spa-link" href="education/index.html"><span class="icon"><i class="fa-solid fa-graduation-cap"></i></span><span class="label">Education</span></a>
        <a class="nav-item spa-link" href="privacy.html"><span class="icon"><i class="fa-solid fa-user-secret"></i></span><span class="label">Privacy Policy</span></a>
        <a class="nav-item spa-link" href="terms.html"><span class="icon"><i class="fa-solid fa-file-contract"></i></span><span class="label">Terms & Conditions</span></a>
      </nav>

      <div class="sidebar-footer">
        <div class="promo" id="promoCard" role="region" aria-label="Promo">
          <div class="close-btn" id="promoClose" title="Close"><i class="fa-solid fa-xmark"></i></div>
          <div class="art"><i class="fa-solid fa-bolt-lightning" style="color:white;font-size:26px;"></i></div>
          <h4>Your realtime edge</h4>
          <p>Connect earnings, scores and watchlists into one live.</p>
          <div class="cta">
            <a href="purchase.html" class="spa-link">
              <i class="fa-solid fa-rocket"></i>
              <span>Upgrade to Pro</span>
            </a>
          </div>
        </div>
      </div>
    </aside>

    <!-- MAIN -->
  <!-- MAIN -->
  <main class="main" id="main" role="main">
    <div id="page" class="content-wide" aria-live="polite">

      <!-- TOP STRIP -->
      <section class="crm-hero-card">
        <div class="crm-hero-left">
          <div class="crm-hero-icon">
             <i class="fa-solid fa-chart-line"></i>
          </div>
          <div class="crm-hero-text">
<h1>AI Financial Scores <span>Archive</span></h1>
<p>Historical AI-generated financial scores and performance insights by earnings date.</p>





            <div class="crm-hero-sub">
              <div class="crm-hero-pill">
                <i class="fa-solid fa-signal"></i>
                <span>Income Statement Overview</span>
              </div>
              <div class="crm-hero-pill">
                <i class="fa-solid fa-layer-group"></i>
                <span>US market &amp; custom watchlists</span>
              </div>
            </div>
          </div>
        </div>

        <div class="crm-hero-right">
          <div class="crm-date-label">Showing data for</div>
          <button class="crm-date-btn" type="button" onclick="document.getElementById('datePicker').showPicker()">
            <i class="fa-regular fa-calendar-days"></i>
            <span id="crm-date-range">Loading...</span>
          </button>
            <input type="date" id="datePicker" style="display:none;">

        </div>
      </section>
       <section class="rt-summary">
  <div class="rt-grid">

    <!-- TRENDING SYMBOLS -->
    <div class="rt-card">
      <div class="rt-title">Trending symbols</div>
      <div class="rt-sub">Most prominent tickers in today's high-score results</div>

      <div id="trending-symbols" class="ts-container"></div>
    </div>

<!-- SESSION PROGRESS -->
<div class="rt-card rt-progress-card">
  <div class="rt-title-row">
    <div class="rt-title">Session progress</div>
    <span class="rt-badge">Realtime</span>
  </div>

  <div class="rt-metric">
    <div class="rt-label">
      <span>Universe scored today</span>
      <strong>63%</strong>
    </div>
    <div class="rt-bar">
      <div class="rt-bar-fill green" style="width:63%"></div>
    </div>
  </div>

  <div class="rt-metric">
    <div class="rt-label">
      <span>Target by session close</span>
      <strong>80%</strong>
    </div>
    <div class="rt-bar">
      <div class="rt-bar-fill blue" style="width:80%"></div>
    </div>
  </div>

  <div class="rt-metric small">
    <span>Symbols with score ≥ 70</span>
    <strong>38</strong>
  </div>
</div>

<div class="rt-card winners-card">
  <div class="rt-title">Winners vs losers</div>
  <div class="rt-sub">Distribution of positive vs negative scores</div>

  <div class="winners-layout">
    <canvas id="winnersPie" width="120" height="120"></canvas>

    <div class="winners-legend">
      <div class="legend-item">
        <span class="dot positive"></span>
        <span>Positive expected move</span>
        <strong id="posPct">0%</strong>
      </div>
      <div class="legend-item">
        <span class="dot negative"></span>
        <span>Negative / flat bias</span>
        <strong id="negPct">0%</strong>
      </div>
    </div>
  </div>
</div>




  </div>
</section>
          <section class="trading-context">

  <!-- CARD 1 -->
  <div class="context-card">
    <div class="context-title">Market Regime</div>
    <div class="context-value">Patient · Reactive</div>
    <div class="context-bar">
      <span style="left:65%"></span>
    </div>
    <div class="context-note">
      Let price come to key levels. Avoid forcing entries.
    </div>
  </div>

  <!-- CARD 2 -->
  <div class="context-card">
    <div class="context-title">Volatility</div>
    <div class="context-value warning">Late Entries Punished</div>
    <div class="context-bar">
      <span class="warn" style="left:78%"></span>
    </div>
    <div class="context-note">
      Chasing momentum increases drawdown risk today.
    </div>
  </div>

  <!-- CARD 3 -->
  <div class="context-card">
    <div class="context-title">Opportunity Quality</div>
    <div class="context-value">VWAP Interaction</div>
    <div class="context-bar">
      <span style="left:58%"></span>
    </div>
    <div class="context-note">
      Prefer entries after confirmation, not initial touch.
    </div>
  </div>

  <!-- CARD 4 -->
  <div class="context-card">
    <div class="context-title">Position Sizing</div>
    <div class="context-value">Reduced / Scaled</div>
    <div class="context-bar">
      <span style="left:42%"></span>
    </div>
    <div class="context-note">
      Scale in only after structure confirms direction.
    </div>
  </div>

</section>

 <section class="spy-market-section">

  <!-- LEFT: SPY PRICE -->
  <div class="card spy-chart-card">
    <div class="spy-chart-placeholder">
      SPY Candlestick Chart<br/>
      VWAP + Levels
    </div>
  </div>

  <!-- CENTER: MARKET STATE -->
  <div class="card spy-state-card">
    <div>
      <div class="card-title">Market State Analyzer</div>

      <div class="market-state-list">
        <div class="market-state-item active">
          Uptrend – Trending
          <div class="market-state-bar"><span></span></div>
        </div>
        <div class="market-state-item">
          Downtrend – Trending
          <div class="market-state-bar"><span></span></div>
        </div>
        <div class="market-state-item">
          Neutral – Range
          <div class="market-state-bar"><span></span></div>
        </div>
        <div class="market-state-item">
          Volatile – Non Trending
          <div class="market-state-bar"><span></span></div>
        </div>
        <div class="market-state-item">
          Transition Phase
          <div class="market-state-bar"><span></span></div>
        </div>
        <div class="market-state-item">
          Extreme / Exhaustion
          <div class="market-state-bar"><span></span></div>
        </div>
      </div>

      <div class="decision-strength">
        <div class="decision-strength-label">Decision Strength: 78 / 100</div>
        <div class="decision-strength-bar"><span></span></div>
      </div>
    </div>

    <div class="spy-ai-analysis">
      AI Analysis:<br/>
      SPY is trading above a rising VWAP with positive momentum.
      Trend continuation favored unless VWAP reclaim fails.
    </div>
  </div>

  <!-- RIGHT: TRADE CARD -->
  <div class="card trade-card">
    <div>
      <div class="card-title">Active Trade Setup</div>

      <div class="trade-bias">LONG BIAS</div>

      <div class="trade-details">
        <div><span>Instrument</span><b>SPY</b></div>
        <div><span>Entry Zone</span><b>VWAP Pullback</b></div>
        <div><span>Stop</span><b>Below VWAP</b></div>
        <div><span>Target</span><b>Session High</b></div>
        <div><span>Timeframe</span><b>5m</b></div>
      </div>

      <div class="trade-risk">
        Risk Note:<br/>
        Avoid entries during volume compression or VIX expansion.
      </div>
    </div>

    <div class="trade-status">
      Trade Allowed
    </div>
  </div>

</section>
<section class="session-intel">

  <div class="session-header">SESSION INTELLIGENCE — TODAY</div>

  <div class="session-grid">

    <!-- MARKET BEHAVIOR TABLE -->
    <div class="session-card">
      <div class="session-title">Market Behavior Log</div>

      <div class="log-table-wrapper">
        <table class="log-table">
          <tbody>
            <tr><td>09:45</td><td>Trend continuation confirmed above VWAP</td></tr>
            <tr><td>10:32</td><td>Volatility compression — follow-through limited</td></tr>
            <tr><td>12:08</td><td>Failed breakout, absorption detected</td></tr>
            <tr><td>14:02</td><td>Buyers regained control near VWAP</td></tr>
            <tr><td>14:18</td><td>Higher lows maintained above VWAP</td></tr>
            <tr><td>14:41</td><td>Liquidity absorption near highs</td></tr>
            <tr><td>15:02</td><td>Momentum slowed into close</td></tr>
            <tr><td>15:28</td><td>No late-session breakout</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- TRADE ACTIVITY TABLE -->
    <div class="session-card">
      <div class="session-title">Trade Activity Log</div>

      <div class="log-table-wrapper">
        <table class="log-table">
          <tbody>
            <tr class="skip"><td>10:11</td><td>Long skipped — late entry risk</td></tr>
            <tr class="trade"><td>11:06</td><td>VWAP pullback entry (partial size)</td></tr>
            <tr class="trade"><td>11:24</td><td>Scaled out near session high</td></tr>
            <tr class="skip"><td>13:41</td><td>No-trade condition maintained</td></tr>
            <tr class="trade"><td>14:55</td><td>Final scale-out into strength</td></tr>
            <tr class="skip"><td>15:10</td><td>Late entry avoided</td></tr>
            <tr class="skip"><td>15:22</td><td>Chasing breakout avoided</td></tr>
            <tr class="skip"><td>15:40</td><td>No trade into close</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- TRADE OUTCOMES -->
    <div class="session-card">
      <div class="session-title">Trade Outcomes</div>

      <div class="outcomes-grid">

        <div class="outcome-metric">
          <span class="label">Trades</span>
          <span class="value">3</span>
        </div>

        <div class="outcome-metric success">
          <span class="label">Winners</span>
          <span class="value">2</span>
        </div>

        <div class="outcome-metric fail">
          <span class="label">Losers</span>
          <span class="value">1</span>
        </div>

        <div class="outcome-metric">
          <span class="label">Win Rate</span>
          <span class="value">66%</span>
        </div>

      </div>

      <!-- PIE PLACEHOLDER -->
      <div class="pie-placeholder">
        Win / Loss Distribution
      </div>

      <!-- AI SUMMARY -->
      <div class="session-summary">
        AI Summary:<br>
        Trade execution aligned with intraday market behavior.
        Late entries were consistently avoided, preserving session edge.
        Partial scaling improved outcome stability.
      </div>

    </div>

  </div>

</section>

<!-- EARNINGS REACTION SECTION -->
<section class="panel" id="daily-candlestick-card">
  <div class="dash-grid-mid">

    <!-- LEFT: 2/3 Candlestick Chart -->
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Daily Candlestick</div>
          <div class="card-sub">Default: AAPL – last 12 months</div>
        </div>
      </div>

      <!-- THIS IS THE EXISTING GRAPH CONTAINER -->
      <div id="price-chart" style="height:420px;"></div>
    </div>

 <!-- RIGHT: 1/3 Earnings Summary -->
<div class="card">

  <div class="card-header">
    <div>
      <div class="card-title">AI Earnings Analysis</div>
      <div class="card-sub">Generated by Analyst44 AI</div>
    </div>
  </div>

  <div class="stat-row"><span>Symbol</span><strong id="er-symbol">—</strong></div>
  <div class="stat-row"><span>Earnings Date</span><strong id="er-date">—</strong></div>
  <div class="stat-row"><span>Total Score</span><strong id="er-score">—</strong></div>
  <div class="stat-row"><span>Created At</span><strong id="er-created">—</strong></div>

  <hr style="border:0;border-top:1px solid rgba(255,255,255,0.08);margin:12px 0">

  <div class="stat-row">
    <span>Volatility</span>
    <strong id="er-volatility">—</strong>
  </div>

<div class="ai-text-block">
  <div class="ai-text-title">Swing Forecast</div>
  <div id="er-swing" class="ai-text-content">—</div>
</div>

<hr style="border:0;border-top:1px solid rgba(255,255,255,0.08);margin:12px 0">

<div class="ai-text-block">
  <div class="ai-text-title">AI Summary</div>
  <div id="er-report" class="ai-text-content">
    Daily price reaction around earnings.
  </div>
</div>




  </div>
</section>

      <!-- SECTION 3 — Latest AI Scores Table -->
       <section class="scores-section">
          <h1>Analyst <span>AI Scores Archive</span></h1>
          <p>Explore historical AI scoring results filtered by earnings date.</p>



  <div class="scores-wrapper">
    <table class="scores-fancy-table">
       <thead>
<tr>
  <th>Symbol</th>
  <th>Earnings Date</th>
  <th>Echo Price</th>
  <th>Total Score</th>
  <th>Profitability</th>
  <th>Growth</th>
  <th>Target Range (Low)</th>
  <th>Target Range (High)</th>
</tr>

    </thead>


      <tbody id="scores-body"></tbody>
    </table>
  </div>
</section>
<section class="scores-mobile" id="scores-mobile">
    <h2>AI Scores</h2>

    <div class="scores-mobile-table-wrapper">
        <table class="scores-mobile-table">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Earnings Date</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody id="scores-mobile-body"></tbody>
        </table>
    </div>
</section>





      <!-- כאן נמשיך בהמשך לבנות את שאר הדשבורד החדש -->

    </div>
  </main>




  </div>

  <script>
    (function(){
      const sidebar = document.getElementById('sidebar');
      const sidebarToggle = document.getElementById('sidebarToggle');
      const main = document.getElementById('main');
      const promoClose = document.getElementById('promoClose');
      const promoCard = document.getElementById('promoCard');
      const mq = window.matchMedia('(max-width:920px)');

      // sidebar toggle
      sidebarToggle.addEventListener('click', ()=>{
        if(mq.matches){
          sidebar.classList.toggle('open');
        } else {
          sidebar.classList.toggle('collapsed');
          main.classList.toggle('narrow');
        }
      });

      // sidebar dropdowns
      document.querySelectorAll(".dropdown-btn").forEach(btn=>{
        btn.addEventListener("click",()=>{
          const open = btn.classList.toggle("open");
          btn.setAttribute('aria-expanded', open ? 'true' : 'false');
          const arrow = btn.querySelector('.dropdown-arrow');
          arrow.style.transform = open ? 'rotate(180deg)' : 'rotate(0deg)';
          const panel = btn.nextElementSibling;
          panel.style.display = open ? 'flex' : 'none';
        });
      });

      // promo close
      promoClose && promoClose.addEventListener('click', ()=>{ promoCard.style.display = 'none'; });

// USER MENU — FIXED
const avatarBtn = document.getElementById('userAvatar');  // ← שינוי חשוב!
const userMenu = document.getElementById('userMenu');

avatarBtn.addEventListener('click', (e)=>{
    e.stopPropagation();
    const open = userMenu.classList.toggle('show');
    avatarBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
});


document.addEventListener('click', (e)=>{
    if (!userMenu.contains(e.target) && !avatarBtn.contains(e.target)) {
        userMenu.classList.remove('show');
    }
});

      // THEME PANEL
      const themeToggle = document.getElementById('themeToggle');
      const themePanel = document.getElementById('themePanel');

      themeToggle.addEventListener('click', (e)=>{
        e.stopPropagation();
        const open = themePanel.classList.toggle('show');
        themeToggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        updateThemeChecks();
      });

      document.addEventListener('click', (e)=>{
        if(!userMenu.contains(e.target) && !avatarBtn.contains(e.target)) userMenu.classList.remove('show');
        if(!themePanel.contains(e.target) && !themeToggle.contains(e.target)) themePanel.classList.remove('show');
        if(mq.matches && sidebar.classList.contains('open')){
          const inside = sidebar.contains(e.target) || sidebarToggle.contains(e.target);
          if(!inside) sidebar.classList.remove('open');
        }
      });

      document.addEventListener('keydown', (e)=>{
        if(e.key==='Escape'){ userMenu.classList.remove('show'); themePanel.classList.remove('show'); sidebar.classList.remove('open'); }
      });

      // THEME MANAGEMENT
      const themeRows = Array.from(document.querySelectorAll('.theme-row'));
      const THEME_KEY = 'falcon_theme_choice';
      function applyTheme(choice){
        document.body.classList.remove('light-theme');
        document.documentElement.classList.remove('auto-theme');
        if(choice === 'light'){ document.body.classList.add('light-theme'); }
        else if(choice === 'dark'){ /* default dark */ }
        else if(choice === 'auto'){ document.documentElement.classList.add('auto-theme'); }
        try{ localStorage.setItem(THEME_KEY, choice); } catch(e){}
        updateThemeChecks();
      }
      function initTheme(){
        let saved = null;
        try{ saved = localStorage.getItem(THEME_KEY); } catch(e){}
        if(!saved) saved = 'dark';
        applyTheme(saved);
      }
      function updateThemeChecks(){
        const current = localStorage.getItem(THEME_KEY) || 'dark';
        themeRows.forEach(r=>{
          const ch = r.querySelector('.check');
          if(r.dataset.theme === current) ch.style.display = 'block'; else ch.style.display = 'none';
        });
      }
      themeRows.forEach(r=>{
        r.addEventListener('click', (e)=>{ const choice = r.dataset.theme; applyTheme(choice); themePanel.classList.remove('show'); });
        r.addEventListener('keydown', (e)=>{ if(e.key === 'Enter' || e.key === ' ') { r.click(); } });
      });

     // LOGOUT FIX — FULL FUNCTION
const logoutBtn = document.getElementById("logoutBtn");

if (logoutBtn) {
    logoutBtn.addEventListener("click", async (e) => {
        e.preventDefault(); // מונע מעבר ל־logout.html

        try {
            const { error } = await supabase.auth.signOut();
            if (error) {
                console.error("Logout error:", error);
            }

            window.location.href = "login.html"; // הפניה מחדש
        } catch (err) {
            console.error(err);
            window.location.href = "login.html";
        }
    });
}


      initTheme();
      updateThemeChecks();
      window.addEventListener('resize', ()=>{ if(!mq.matches) sidebar.classList.remove('open'); });

      /* SPA loader */
      document.addEventListener('click', async (ev)=>{
        const a = ev.target.closest('a.spa-link');
        if(!a) return;
        if(a.target === '_blank' || a.href.startsWith('http')) return;
        ev.preventDefault();
        const url = a.getAttribute('href');
        try{
          const res = await fetch(url, {cache: 'no-store'});
          if(!res.ok){ window.location.href = url; return; }
          const html = await res.text();
          const doc = new DOMParser().parseFromString(html, 'text/html');
          const page = doc.getElementById('page') || doc.querySelector('main') || doc.body;
          if(page) main.innerHTML = page.innerHTML; else main.innerHTML = html;
          history.pushState({spa:true, url}, '', url);
          if(typeof window.onPageLoaded === 'function') window.onPageLoaded(url);
        }catch(err){ console.error('SPA load failed', err); window.location.href = url; }
      });

      window.addEventListener('popstate', async (ev)=>{
        if(ev.state && ev.state.url){
          try{
            const res = await fetch(ev.state.url);
            const html = await res.text();
            const doc = new DOMParser().parseFromString(html, 'text/html');
            const page = doc.getElementById('page') || doc.querySelector('main') || doc.body;
            document.querySelector('main').innerHTML = (page && page.innerHTML) || html;
          }catch(e){ location.reload(); }
        } else { location.reload(); }
      });
      // =========================
      // SPA callback – run after page load
      // =========================
    window.onPageLoaded = function(url) {
    if (url.includes("realtime_scores")) {
        if (typeof loadCRMDateRange === "function") loadCRMDateRange();
        if (typeof loadLatestScores === "function") loadLatestScores();
    }
};


    })();
</script>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const supabase = createClient(
  "https://xkchlqcwntcoakmyicqb.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhrY2hscWN3bnRjb2FrbXlpY3FiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4MDMyNzEsImV4cCI6MjA3ODM3OTI3MX0.702fpZLEHukvswrY0uwHknQYwdNDW-HeNsQxu_f1NnU"
);
window.supabase = supabase;
// === SESSION CHECK ===
const { data: { session } } = await supabase.auth.getSession();

if (!session) {
    window.location.href = "login.html";
}

// === LOAD USER AVATAR ===
const avatarEl = document.getElementById("userAvatar");

if (avatarEl) {
    const avatarUrl = session.user.user_metadata?.avatar_url;

    if (avatarUrl) {
        avatarEl.style.backgroundImage = `url('${avatarUrl}')`;
    } else {
        avatarEl.textContent = session.user.email.charAt(0).toUpperCase();
        avatarEl.style.display = "flex";
        avatarEl.style.alignItems = "center";
        avatarEl.style.justifyContent = "center";
        avatarEl.style.fontWeight = "700";
        avatarEl.style.fontSize = "18px";
    }
}


// Avatar update
const avatar = document.getElementById("avatarBtn");
if (avatar) {
    if (session.user.user_metadata?.avatar_url) {
        avatar.style.backgroundImage = `url('${session.user.user_metadata.avatar_url}')`;
    } else {
        avatar.textContent = session.user.email.charAt(0).toUpperCase();
    }
}
</script>

<script type="module" src="realtime_scores_logic.js"></script>
<script type="module">

import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const supabase = createClient(
  "https://xkchlqcwntcoakmyicqb.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhrY2hscWN3bnRjb2FrbXlpY3FiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI4MDMyNzEsImV4cCI6MjA3ODM3OTI3MX0.702fpZLEHukvswrY0uwHknQYwdNDW-HeNsQxu_f1NnU" // המפתח שלך
);

async function loadFinancialScores(selectedDate = null) {
  const tbody = document.getElementById("scores-body");
  tbody.innerHTML = "<tr><td colspan='9'>Loading...</td></tr>";

  let targetDate = selectedDate;

// If no date is provided → use latest
if (!targetDate) {
  let { data: dates, error: e1 } = await supabase
    .from("analyst_financial_scores")
    .select("last_earnings_date")
    .order("last_earnings_date", { ascending: false })
    .limit(1);

  if (e1 || !dates || dates.length === 0) {
    console.error(e1);
    tbody.innerHTML = "<tr><td colspan='9'>No data</td></tr>";
    return;
  }

  targetDate = dates[0].last_earnings_date;
}


  // Update header UI
  document.getElementById("crm-date-range").textContent = targetDate;

  // Fetch rows for the chosen date
let { data, error } = await supabase
  .from("analyst_financial_scores")
  .select(`
    symbol,
    last_earnings_date,
    echo_price,
    total_score,
    profitability,
    growth,
    target_range_low,
    target_range_high,
    summary_30_words,
    volatility_flag,
    swing_forecast_weeks_2_3,
    created_at
  `)

    .eq("last_earnings_date", targetDate)
    .order("symbol", { ascending: true });

  if (error) {
    console.error(error);
    tbody.innerHTML = "<tr><td colspan='9'>Error loading data</td></tr>";
    return;
  }

  // Remove duplicates by symbol
  const unique = [];
  const seen = new Set();
  for (const row of data) {
    if (!seen.has(row.symbol)) {
      unique.push(row);
      seen.add(row.symbol);
    }
  }

  // Render
  tbody.innerHTML = "";
  const mobileBody = document.getElementById("scores-mobile-body");
  mobileBody.innerHTML = "";

  unique.forEach(row => {
const tr = document.createElement("tr");
tr.style.cursor = "pointer";

tr.innerHTML = `
  <td>${row.symbol}</td>
  <td>${row.last_earnings_date}</td>
  <td>${row.echo_price ?? "-"}</td>
  <td class="${classifyScore(row.total_score)}">${row.total_score ?? "-"}</td>
  <td>${row.profitability ?? "-"}</td>
  <td>${row.growth ?? "-"}</td>
  <td>${row.target_range_low ?? "-"}</td>
  <td>${row.target_range_high ?? "-"}</td>
`;

 tr.addEventListener("click", () => {
  // ✅ Remove highlight from previous rows (REAL selector)
  document.querySelectorAll("#scores-body tr.row-selected")
    .forEach(r => r.classList.remove("row-selected"));

  // ✅ Highlight current row
  tr.classList.add("row-selected");

  // ✅ Load chart + AI panel
  loadDailyChart(
    row.symbol,
    row.last_earnings_date,
    row.total_score ?? "—",
    row.summary_30_words || "",
    row.volatility_flag,
    row.swing_forecast_weeks_2_3,
    row.created_at
  );

  // ✅ Auto scroll to chart (works even if main is the scroller)
  const chartEl = document.getElementById("daily-candlestick-card");
  if (!chartEl) return;

  const mainScroller = document.getElementById("main");
  const topOffset = 16;

  if (mainScroller && mainScroller.scrollHeight > mainScroller.clientHeight) {
    const chartTop = chartEl.getBoundingClientRect().top - mainScroller.getBoundingClientRect().top;
    mainScroller.scrollTo({ top: chartTop + mainScroller.scrollTop - topOffset, behavior: "smooth" });
  } else {
    const y = window.scrollY + chartEl.getBoundingClientRect().top - topOffset;
    window.scrollTo({ top: y, behavior: "smooth" });
  }
});




tbody.appendChild(tr);

    mobileBody.innerHTML += `
      <tr>
        <td>${row.symbol}</td>
        <td>${row.last_earnings_date}</td>
        <td class="${classifyScore(row.total_score)}">${row.total_score ?? "-"}</td>
      </tr>
    `;
  });
}

loadFinancialScores();
window.loadFinancialScores = loadFinancialScores;


</script>
<script>
function renderTrendingSymbols(data) {
  const container = document.getElementById("trending-symbols");
  if (!container) return;


  container.innerHTML = "";


  const top10 = data
    .filter(item => item.total_score !== null)
    .sort((a, b) => b.total_score - a.total_score)
    .slice(0, 10);


top10.forEach(item => {
  const div = document.createElement("div");
  div.className = "rt-symbol";
  div.innerText = item.symbol;

  div.dataset.symbol = item.symbol;
  div.style.cursor = "pointer";

div.addEventListener("click", () => {
  loadDailyChart(item.symbol);
  loadAIScore(item.symbol);   // ← זו השורה שחסרה
});

  container.appendChild(div);
});

}
function updatePieChart(winners, losers) {
    const pie = document.querySelector(".rt-pie");
    const center = document.querySelector(".rt-pie-center strong");

    const total = winners + losers;
    const winPct = total === 0 ? 0 : Math.round((winners / total) * 100);

    pie.style.background = `conic-gradient(#3b82f6 0 ${winPct}%, #1f2937 ${winPct}% 100%)`;
    center.textContent = winPct + "%";


}


document.addEventListener("DOMContentLoaded", () => {

  const observer = new MutationObserver(() => {
    const rows = document.querySelectorAll("#scores-body tr");
    if (rows.length === 0) return;

    const data = Array.from(rows).map(row => {
   const tds = row.querySelectorAll("td");
   return {
      symbol: tds[0]?.innerText.trim(),
      total_score: parseInt(tds[4]?.innerText.trim() || "0")
   };
});

 const total = data.length;
let positive = data.filter(x => x.total_score >= 50).length;
let negative = total - positive;

const positivePct = total > 0 ? Math.round((positive / total) * 100) : 0;
const negativePct = 100 - positivePct;


document.getElementById("pie-positive-pct").textContent = positivePct + "%";
document.getElementById("pie-negative-pct").textContent = negativePct + "%";
document.getElementById("pie-center-pct").textContent = positivePct + "%";


updatePieChart(positivePct, negativePct);


renderTrendingSymbols(data);



    const winners = data.filter(x => x.total_score >= 50).length;
    const losers  = data.filter(x => x.total_score < 50).length;
    updatePieChart(winners, losers);
  });

  observer.observe(document.getElementById("scores-body"), { childList: true });
});

</script>
<script>
document.querySelector(".crm-date-btn").addEventListener("click", () => {
    document.getElementById("datePicker").showPicker();
});
</script>
<script>
document.getElementById("datePicker").addEventListener("change", (e) => {
    const selected = e.target.value;

    if (selected) {

        document.getElementById("crm-date-range").textContent = selected;


        loadFinancialScores(selected);
    }
});

function classifyScore(score) {
    const s = Number(score);

    if (isNaN(s)) return "";

    // Red group (0–40)
    if (s >= 0 && s < 5) return "score-red-1";
    if (s >= 5 && s < 10) return "score-red-2";
    if (s >= 10 && s < 15) return "score-red-3";
    if (s >= 15 && s < 20) return "score-red-4";
    if (s >= 20 && s < 30) return "score-red-5";
    if (s >= 30 && s < 40) return "score-red-6";

    // Blue group (40–60)
    if (s >= 40 && s < 50) return "score-blue-1";
    if (s >= 50 && s < 55) return "score-blue-2";
    if (s >= 55 && s < 60) return "score-blue-3";

    // Green group (60–100)
    if (s >= 60 && s < 65) return "score-green-1";
    if (s >= 65 && s < 70) return "score-green-2";
    if (s >= 70 && s < 80) return "score-green-3";
    if (s >= 80 && s < 90) return "score-green-4";
    if (s >= 90 && s < 95) return "score-green-5";
    if (s >= 95) return "score-green-6";

    return "";
}



</script>
<script>
async function loadDailyChart(
  symbol,
  earningsDate,
  totalScore,
  aiSummaryText,
  volatilityFlag = null,
  swingForecast = null,
  createdAt = null
) {

    const apiKey = "ZT73H6uSdo3b3kAmcjPxH5EGX0odj7MJ";

    const url = `https://financialmodelingprep.com/api/v3/historical-price-full/${symbol}?apikey=${apiKey}`;
    const res = await fetch(url);
    const data = await res.json();

    if (!data.historical) {
        console.error("No historical data for", symbol);
        return;
    }

    const candles = data.historical
        .slice(0, 90)
        .reverse()
        .map(d => ({
            x: new Date(d.date),
            y: [d.open, d.high, d.low, d.close]
        }));

const options = {
  chart: {
    type: "candlestick",
    height: 420,
    background: "transparent",
    toolbar: { show: false }
  },
  series: [{ name: symbol, data: candles }],
  xaxis: {
    type: "datetime",
    labels: { style: { colors: "#9fb0c7" } }
  },
  yaxis: {
    labels: { style: { colors: "#9fb0c7" } }
  },

  annotations: {
    xaxis: [
      {
        x: new Date(earningsDate).getTime(),
        borderColor: "#22c55e",
        strokeDashArray: 4,
        label: {
          text: "Earnings",
          style: {
            color: "#fff",
            background: "#22c55e",
            fontSize: "12px"
          }
        }
      }
    ]
  }
};


    document.getElementById("price-chart").innerHTML = "";
    new ApexCharts(document.querySelector("#price-chart"), options).render();

    // Right panel update
document.getElementById("er-symbol").innerText = symbol;
document.getElementById("er-date").innerText = earningsDate;
document.getElementById("er-score").innerText = totalScore;

document.getElementById("er-report").innerText =
  aiSummaryText && aiSummaryText.length
    ? aiSummaryText
    : "Daily price reaction around earnings.";

document.getElementById("er-volatility").innerText =
  volatilityFlag || "N/A";

document.getElementById("er-swing").innerText =
  swingForecast || "N/A";

document.getElementById("er-created").innerText =
  createdAt
    ? new Date(createdAt).toLocaleString()
    : "—";


}


document.addEventListener("DOMContentLoaded", () => {
    loadDailyChart("AAPL", "Last earnings", "—");
});
</script>

<script>
function updateTrendingFromTable() {
  const rows = document.querySelectorAll("#scores-body tr");
  if (!rows.length) return;

  const data = Array.from(rows).map(r => ({
    symbol: r.children[0]?.innerText.trim(),
    score: Number(r.children[3]?.innerText)
  }))
  .filter(x => x.score > 0)
  .sort((a,b) => b.score - a.score)
  .slice(0, 8);

  const box = document.getElementById("trending-symbols");
  box.innerHTML = "";

  data.forEach(item => {
    const el = document.createElement("div");
    el.className = "ts-circle";
    el.textContent = item.symbol;

    el.onclick = () => {
      rows.forEach(r => {
        if (r.children[0]?.innerText.trim() === item.symbol) {
          r.click();
        }
      });
    };

    box.appendChild(el);
  });
}

new MutationObserver(updateTrendingFromTable)
  .observe(document.getElementById("scores-body"), { childList: true });
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let winnersChart = null;

async function loadWinnersVsLosers() {
  const { data, error } = await supabase
    .from('analyst_financial_scores')
    .select('total_score');

  if (error) return;

  const positive = data.filter(r => r.total_score >= 50).length;
  const negative = data.filter(r => r.total_score < 50).length;
  const total = positive + negative;

  const posPct = total ? Math.round((positive / total) * 100) : 0;
  const negPct = 100 - posPct;

  document.getElementById('posPct').innerText = posPct + '%';
  document.getElementById('negPct').innerText = negPct + '%';

  const ctx = document.getElementById('winnersPie').getContext('2d');

  if (winnersChart) winnersChart.destroy();

winnersChart = new Chart(ctx, {
  type: 'doughnut',
  data: {
    datasets: [{
      data: [positive, negative],

      backgroundColor: [
        '#4f8cff',   // כחול חי
        '#2b3a4f'    // אפור כהה
      ],

      borderWidth: 0,
      borderRadius: 20,   // קצוות עגולים (קריטי)
      spacing: 6,         // רווח בין הקשתות
      hoverOffset: 0
    }]
  },
  options: {
    responsive: false,

    cutout: '60%',       // <<< זה הסוד למראה הזה
    rotation: -90,
    circumference: 360,

    plugins: {
      legend: { display: false },
      tooltip: { enabled: false }
    },

    animation: {
      duration: 600,
      easing: 'easeOutQuart'
    }
  }
});



}

document.addEventListener("DOMContentLoaded", loadWinnersVsLosers);
</script>

</body>
</html>
